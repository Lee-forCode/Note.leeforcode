

# MySQL的主从复制

>一句话总结：
>
>从服务器（slave）通过I/O线程从主服务器（master）复制binarylog文件，通过SQL 线程解析binarylog，并在从服务器上执行翻译/解析后的SQL语句，实现主从数据同步！
>
>重点：3个线程- - 1主2从
>
>Binarylog文件
>
>Relaylog文件

## 一、简介

### 1.1 主从复制的优越性– – 保证数据的可靠

![img](H:\笔记\Note_Code\images\820365-20160821160605026-595389100.png)

- #### 1） 数据可备份

- #### 2）负载均衡

- #### 3）数据分布

### 1.2 原理简介 – – 异步复制

Master服务器上用户执行操作，并将操作记录于binarylog中。Master通过`log dump线程`，将bin-log 传递给 Slave。       Slave 通过``I/O线程``将接受(读取)的 binlog 写入 relay-log中，实现binlog复制；

再者，Slave通过``SQL线程``读取 relaylog 文件，实现主从数据同步

![img](H:\笔记\Note_Code\images\MySQL主从.png)

- #### 1.2.1 Binarylog – –二进制日志文件

- #### 1.2.2 Relaylog中继日志

<img src="https://images2015.cnblogs.com/blog/820365/201608/820365-20160821160632292-210490874.png" alt="img" style="zoom:67%;" />

​	

## 二、改进

>存在问题：
>
>- 主库宕机，数据丢失：主库宕机未完成 binlog 的传递 – – 半同步复制
>- 从库只有一个SQL线程，主库写压力大时，会造成复制延迟
>
>

### 2.1 半同步复制

![img](H:\笔记\Note_Code\images\820365-20160821160639917-571481540.png)

### 2.2 并行复制



## 三、配置

